<!doctype html>
<html lang="en">
  <head>
    <title>Document</title>
    <script src="csv_parser.js"></script>
    <script src="autogrouper.js"></script>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <h1>ALSTAR First Event Autogrouper</h1>

    <h3>Instructions</h3>
    <ol>
      <li>
        Download the Google Sheets containing the Google Forms data as a .csv
        file. (Note: The program only works on forms using 'Multiple Choice
        Grid' for selecting choices.)
      </li>
      <li>In the 'Data file (.csv)' option, select and load the .csv file.</li>
      <li>
        In the 'Names column' option, enter the column number of the column
        containing the names in the spreadsheet. Example: Column B contains the
        names, so enter 2.
      </li>
      <li>
        In the 'Groups column' option, enter the start and end column number of
        the groups. Example: Column C is the first group and Column E is the
        last group, so enter 3 and 5.
      </li>
      <li>
        In the next option, enter the labels used for the choices, separated by
        commas. Example: If my choices are labelled '1st Choice', '2nd Choice'
        and '3rd Choice', enter '1st Choice, 2nd Choice, 3rd Choice'.
        Capitalisation matters. You can set more than 3 choices.
      </li>
      <li>
        In the 'Max members per group' option, enter the maximum number of
        people each group can have.
      </li>
      <li>Click the 'Generate Groupings' button.</li>
    </ol>

    <hr />

    <div class="split">
      <div>
        <p>
          Data file (.csv):
          <input type="file" name="data" id="data" accept=".csv" />
        </p>
        <p>
          Names column:
          <input
            type="number"
            name="namesCol"
            id="namesCol"
            min="1"
            size="1"
            placeholder="1"
          />
        </p>
        <p>
          Groups column: from
          <input
            type="number"
            name="choicesFromCol"
            id="choicesFromCol"
            min="1"
            size="1"
            placeholder="1"
          />
          to
          <input
            type="number"
            name="choicesToCol"
            id="choicesToCol"
            min="1"
            size="1"
            placeholder="1"
          />
        </p>
        <p>
          Labels used for the choices (separated by commas, capitalisation matters):
          <br />
          <input
            type="text"
            name="choiceLabels"
            id="choiceLabels"
            size="100"
            placeholder="1st Choice, 2nd Choice, 3rd Choice"
          />
        </p>
        <p>
          Max members per group:
          <input
            type="number"
            name="maxPeople"
            id="maxPeople"
            min="1"
            size="1"
            placeholder="1"
          />
        </p>
      </div>
      <div>
        <p>
          <input type="checkbox" name="submitOrder" id="submitOrder" />
          <label for="submitOrder"
            >Show the order of submission for each person</label
          >
          <br />
          <input type="checkbox" name="personChoice" id="personChoice" />
          <label for="personChoice">Show what choice each person got</label>
          <br />
          <input type="checkbox" name="uppercase" id="uppercase" checked />
          <label for="uppercase">Display all names in uppercase</label>
          <br /><br />
          <input type="radio" name="sort" id="sortSubmit" checked />
          <label for="sortSubmit">Sort names by order of submission</label>
          <br />
          <input type="radio" name="sort" id="sortAlpha" checked />
          <label for="sortAlpha">Sort names by alphabetical order</label>
        </p>
      </div>
    </div>
    <p><button id="submit">Generate Groupings</button></p>

    <div class="split output">
      <div>
        Results:
        <textarea
          name="results"
          id="results"
          rows="40"
          placeholder="The calculated groupings will be shown here"
          disabled
        ></textarea>
      </div>
      <div>
        Log:
        <textarea
          name="log"
          id="log"
          rows="40"
          placeholder="Any warnings or errors will be shown here"
          wrap="off"
          disabled
        ></textarea>
      </div>
    </div>

    <script src="index.js"></script>
  </body>
</html>
